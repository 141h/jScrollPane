/*
 * jScrollPane - v2.0.0beta1 - 2010-08-03
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(H,G){var q=this,A,t,J,r,v,z,D,m,K,l,w,i,g,E,p,h,o;t={};B(G);function B(L){var N,M;if(A==c){H.css("overflow","hidden");J=H.innerWidth();r=H.innerHeight();A=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:J+"px",height:r+"px"}));H.css("overflow","visible");H.wrap(A.parent());A=H.parent();v=A.parent();H.find(":first-child").addClass("jspFirst");H.find(":last-child").addClass("jspLast")}else{J=v.outerWidth();r=v.outerHeight();v.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}H.css({width:"auto",height:"auto"});N=H.clone().css("position","absolute");M=b('<div style="width:1px; position: relative;" />').append(N);b("body").append(M);z=Math.max(H.outerWidth(),N.outerWidth());M.remove();D=H.outerHeight();m=z/J;K=D/r;l=K>1;w=m>1;if(!(w||l)){H.removeClass("jspScrollable");A.css("top",0);u()}else{H.addClass("jspScrollable");I();F()}}function I(){if(l){var R,M,Q,O,N,P,L;v.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));R=v.find(">.jspVerticalBar");M=R.find(">.jspTrack");i=M.find(">.jspDrag");Q=G.verticalGutter+M.outerWidth();A.width(J-Q);if(R.position().left==0){A.css("margin-left",Q+"px")}D=H.outerHeight();K=D/r;if(G.showArrows){P=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",y(0,-1)).bind("click.jsp",n);L=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",y(0,1)).bind("click.jsp",n);M.before(P).after(L)}O=r;v.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){O-=b(this).outerHeight()});M.height(O+"px");N=1/K*O;i.height(N+"px");g=O-N;E=0;i.hover(function(){i.addClass("jspHover")},function(){i.removeClass("jspHover")}).bind("mousedown.jsp",function(T){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var S=T.pageY-i.position().top;b("html").bind("mousemove.jsp",function(U){j(U.pageY-S)}).bind("mouseup.jsp mouseleave.jsp",C);return false});x()}else{u()}}function F(){if(w){var P,O,L,N,Q,R,M;v.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));P=v.find(">.jspHorizontalBar");O=P.find(">.jspTrack");p=O.find(">.jspDrag");L=G.horizontalGutter+O.outerHeight();A.height(r-L);if(G.showArrows){R=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",y(-1,0)).bind("click.jsp",n);M=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",y(1,0)).bind("click.jsp",n);O.before(R).after(M)}N=v.innerWidth();v.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){N-=b(this).outerWidth()});O.width(N+"px");Q=1/m*N;p.width(Q+"px");h=N-Q;o=0;p.hover(function(){p.addClass("jspHover")},function(){p.removeClass("jspHover")}).bind("mousedown.jsp",function(T){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var S=T.pageX-p.position().left;b("html").bind("mousemove.jsp",function(U){k(U.pageX-S)}).bind("mouseup.jsp mouseleave.jsp",C);return false})}else{}}function y(M,L){return function(){s(M,L);this.blur();return false}}function s(N,L){var M=setInterval(function(){if(N!=0){k(o+N*G.arrowButtonSpeed)}if(L!=0){j(E+L*G.arrowButtonSpeed)}},G.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(M);b("html").unbind("mouseup.jsp")})}function C(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")
}function j(L){if(L<0){L=0}else{if(L>g){L=g}}E=L;i.css("top",L);v.scrollTop(0);var M=L/g;A.css("top",-M*(D-r))}function k(L){if(L<0){L=0}else{if(L>h){L=h}}o=L;p.css("left",L);v.scrollTop(0);var M=L/h;A.css("left",-M*(z-J))}function x(){v.bind("mousewheel.jsp",function(L,N){var M=E;j(E-N*G.mouseWheelSpeed);return M==E})}function u(){v.unbind("mousewheel.jsp")}function n(){return false}b.extend(q,{reinitialise:function(L){B(L)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);