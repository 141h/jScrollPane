/*
 * jScrollPane - v2.0.0beta1 - 2010-08-03
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(R,W){var g=this,P,y,H,aa,K,V,O,u,n,Z,j,L,q,m,Y,t,F,Q,J,l,I,s,M,v,x,E,k,A,p,X;y={};z(W);function z(ab){var ad,ac;if(P==c){R.css("overflow","hidden");H=R.innerWidth();aa=R.innerHeight();P=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:H+"px",height:aa+"px"}));R.css("overflow","visible");R.wrap(P.parent());P=R.parent();K=P.parent();R.find(":first-child").addClass("jspFirst");R.find(":last-child").addClass("jspLast")}else{H=K.outerWidth();aa=K.outerHeight();K.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}R.css({width:"auto",height:"auto"});ad=R.clone().css("position","absolute");ac=b('<div style="width:1px; position: relative;" />').append(ad);b("body").append(ac);V=Math.max(R.outerWidth(),ad.outerWidth());ac.remove();O=R.outerHeight();u=V/H;n=O/aa;Z=n>1;j=u>1;if(!(j||Z)){R.removeClass("jspScrollable");P.css("top",0);G()}else{R.addClass("jspScrollable");o();T();h()}}function o(){if(Z){K.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));Q=K.find(">.jspVerticalBar");J=Q.find(">.jspTrack");L=J.find(">.jspDrag");if(W.showArrows){M=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",w(0,-1)).bind("click.jsp",S);v=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",w(0,1)).bind("click.jsp",S);J.before(M).after(v)}I=aa;K.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){I-=b(this).outerHeight()});L.hover(function(){L.addClass("jspHover")},function(){L.removeClass("jspHover")}).bind("mousedown.jsp",function(ac){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var ab=ac.pageY-L.position().top;b("html").bind("mousemove.jsp",function(ad){B(ad.pageY-ab)}).bind("mouseup.jsp mouseleave.jsp",r);return false});D();i()}else{G()}}function D(){J.height(I+"px");m=0;l=W.verticalGutter+J.outerWidth();P.width(H-l);if(Q.position().left==0){P.css("margin-left",l+"px")}}function T(){if(j){K.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));x=K.find(">.jspHorizontalBar");E=x.find(">.jspTrack");Y=E.find(">.jspDrag");if(W.showArrows){p=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",w(-1,0)).bind("click.jsp",S);X=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",w(1,0)).bind("click.jsp",S);E.before(p).after(X)}Y.hover(function(){Y.addClass("jspHover")},function(){Y.removeClass("jspHover")}).bind("mousedown.jsp",function(ac){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var ab=ac.pageX-Y.position().left;b("html").bind("mousemove.jsp",function(ad){C(ad.pageX-ab)}).bind("mouseup.jsp mouseleave.jsp",r);return false});k=K.innerWidth();N()}else{}}function N(){P.height(aa-W.horizontalGutter-E.outerHeight());K.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){k-=b(this).outerWidth()});E.width(k+"px");F=0}function h(){if(j&&Z){var ab=E.outerHeight(),ac=J.outerWidth();I-=ab;k-=ac;aa-=ac;H-=ab;E.parent().append(b('<div class="jspCorner" />').css("width",ab+"px"));D();N()}if(j){P.width(K.outerWidth()+"px")}O=R.outerHeight();n=O/aa;if(j){A=1/u*k;Y.width(A+"px");t=k-A}if(Z){s=1/n*I;L.height(s+"px");q=I-s}}function w(ac,ab){return function(){U(ac,ab);this.blur();return false}}function U(ad,ab){var ac=setInterval(function(){if(ad!=0){C(F+ad*W.arrowButtonSpeed)
}if(ab!=0){B(m+ab*W.arrowButtonSpeed)}},W.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(ac);b("html").unbind("mouseup.jsp")})}function r(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")}function B(ab){if(ab<0){ab=0}else{if(ab>q){ab=q}}m=ab;L.css("top",ab);K.scrollTop(0);var ac=ab/q;P.css("top",-ac*(O-aa))}function C(ab){if(ab<0){ab=0}else{if(ab>t){ab=t}}F=ab;Y.css("left",ab);K.scrollTop(0);var ac=ab/t;P.css("left",-ac*(V-H))}function i(){K.bind("mousewheel.jsp",function(ab,ad){var ac=m;B(m-ad*W.mouseWheelSpeed);return ac==m})}function G(){K.unbind("mousewheel.jsp")}function S(){return false}b.extend(g,{reinitialise:function(ab){z(ab)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);