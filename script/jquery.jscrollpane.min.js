/*
 * jScrollPane - v2.0.0beta1 - 2010-08-03
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(Q,V){var g=this,O,z,H,Z,K,U,N,v,n,Y,j,L,r,m,X,u,F,P,J,l,I,t,M,w,y,E,o,k,B,q,W;z={};A(V);function A(aa){var ac,ab;if(O==c){Q.css("overflow","hidden");H=Q.innerWidth();Z=Q.innerHeight();O=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:H+"px",height:Z+"px"}));Q.css("overflow","visible");Q.wrap(O.parent());O=Q.parent();K=O.parent();Q.find(":first-child").addClass("jspFirst");Q.find(":last-child").addClass("jspLast")}else{H=K.outerWidth();Z=K.outerHeight();K.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}Q.css({width:"auto",height:"auto"});ac=Q.clone().css("position","absolute");ab=b('<div style="width:1px; position: relative;" />').append(ac);b("body").append(ab);U=Math.max(Q.outerWidth(),ac.outerWidth());ab.remove();N=Q.outerHeight();v=U/H;n=N/Z;Y=n>1;j=v>1;if(!(j||Y)){Q.removeClass("jspScrollable");O.css("top",0);G()}else{Q.addClass("jspScrollable");p();S();h()}}function p(){if(Y){K.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));P=K.find(">.jspVerticalBar");J=P.find(">.jspTrack");L=J.find(">.jspDrag");l=V.verticalGutter+J.outerWidth();O.width(H-l);if(P.position().left==0){O.css("margin-left",l+"px")}if(V.showArrows){M=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",x(0,-1)).bind("click.jsp",R);w=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",x(0,1)).bind("click.jsp",R);J.before(M).after(w)}I=Z;K.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){I-=b(this).outerHeight()});J.height(I+"px");m=0;L.hover(function(){L.addClass("jspHover")},function(){L.removeClass("jspHover")}).bind("mousedown.jsp",function(ab){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var aa=ab.pageY-L.position().top;b("html").bind("mousemove.jsp",function(ac){C(ac.pageY-aa)}).bind("mouseup.jsp mouseleave.jsp",s);return false});i()}else{G()}}function S(){if(j){K.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));y=K.find(">.jspHorizontalBar");E=y.find(">.jspTrack");X=E.find(">.jspDrag");o=V.horizontalGutter+E.outerHeight();O.height(Z-o);if(V.showArrows){q=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",x(-1,0)).bind("click.jsp",R);W=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",x(1,0)).bind("click.jsp",R);E.before(q).after(W)}k=K.innerWidth();K.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){k-=b(this).outerWidth()});E.width(k+"px");F=0;X.hover(function(){X.addClass("jspHover")},function(){X.removeClass("jspHover")}).bind("mousedown.jsp",function(ab){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var aa=ab.pageX-X.position().left;b("html").bind("mousemove.jsp",function(ac){D(ac.pageX-aa)}).bind("mouseup.jsp mouseleave.jsp",s);return false})}else{}}function h(){if(j&&Y){}N=Q.outerHeight();n=N/Z;if(j){B=1/v*k;X.width(B+"px");u=k-B}if(Y){t=1/n*I;L.height(t+"px");r=I-t}}function x(ab,aa){return function(){T(ab,aa);this.blur();return false}}function T(ac,aa){var ab=setInterval(function(){if(ac!=0){D(F+ac*V.arrowButtonSpeed)}if(aa!=0){C(m+aa*V.arrowButtonSpeed)}},V.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(ab);b("html").unbind("mouseup.jsp")})}function s(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")
}function C(aa){if(aa<0){aa=0}else{if(aa>r){aa=r}}m=aa;L.css("top",aa);K.scrollTop(0);var ab=aa/r;O.css("top",-ab*(N-Z))}function D(aa){if(aa<0){aa=0}else{if(aa>u){aa=u}}F=aa;X.css("left",aa);K.scrollTop(0);var ab=aa/u;O.css("left",-ab*(U-H))}function i(){K.bind("mousewheel.jsp",function(aa,ac){var ab=m;C(m-ac*V.mouseWheelSpeed);return ab==m})}function G(){K.unbind("mousewheel.jsp")}function R(){return false}b.extend(g,{reinitialise:function(aa){A(aa)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);