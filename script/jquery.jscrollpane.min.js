/*
 * jScrollPane - v2.0.0beta1 - 2010-08-05
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(U,aa){var g=this,S,B,K,ae,N,Z,R,x,n,ad,j,O,t,m,ac,w,I,T,M,l,L,v,P,y,A,H,k,D,s,ab;B={};C(aa);function C(af){var ah,ag;if(S==c){U.css("overflow","hidden");K=U.innerWidth();ae=U.innerHeight();S=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:K+"px",height:ae+"px"}));U.css("overflow","visible");U.wrap(S.parent());S=U.parent();N=S.parent();U.find(":first-child").addClass("jspFirst");U.find(":last-child").addClass("jspLast")}else{K=N.outerWidth();ae=N.outerHeight();N.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}U.css({width:"auto",height:"auto"});ah=U.clone().css("position","absolute");ag=b('<div style="width:1px; position: relative;" />').append(ah);b("body").append(ag);Z=Math.max(U.outerWidth(),ah.outerWidth());ag.remove();R=U.outerHeight();x=Z/K;n=R/ae;ad=n>1;j=x>1;if(!(j||ad)){U.removeClass("jspScrollable");S.css("top",0);J();o()}else{U.addClass("jspScrollable");r();W();h();p()}}function r(){if(ad){N.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));T=N.find(">.jspVerticalBar");M=T.find(">.jspTrack");O=M.find(">.jspDrag");if(aa.showArrows){P=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",z(0,-1)).bind("click.jsp",V);y=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",z(0,1)).bind("click.jsp",V);M.before(P).after(y)}L=ae;N.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){L-=b(this).outerHeight()});O.hover(function(){O.addClass("jspHover")},function(){O.removeClass("jspHover")}).bind("mousedown.jsp",function(ag){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var af=ag.pageY-O.position().top;b("html").bind("mousemove.jsp",function(ah){E(ah.pageY-af)}).bind("mouseup.jsp mouseleave.jsp",u);return false});G();i()}else{J()}}function G(){M.height(L+"px");m=0;l=aa.verticalGutter+M.outerWidth();S.width(K-l);if(T.position().left==0){S.css("margin-left",l+"px")}}function W(){if(j){N.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));A=N.find(">.jspHorizontalBar");H=A.find(">.jspTrack");ac=H.find(">.jspDrag");if(aa.showArrows){s=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",z(-1,0)).bind("click.jsp",V);ab=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",z(1,0)).bind("click.jsp",V);H.before(s).after(ab)}ac.hover(function(){ac.addClass("jspHover")},function(){ac.removeClass("jspHover")}).bind("mousedown.jsp",function(ag){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var af=ag.pageX-ac.position().left;b("html").bind("mousemove.jsp",function(ah){F(ah.pageX-af)}).bind("mouseup.jsp mouseleave.jsp",u);return false});k=N.innerWidth();Q()}else{}}function Q(){S.height(ae-aa.horizontalGutter-H.outerHeight());N.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){k-=b(this).outerWidth()});H.width(k+"px");I=0}function h(){if(j&&ad){var ag=H.outerHeight(),af=M.outerWidth();L-=ag;if(aa.showArrows){k+=s.outerWidth()+ab.outerWidth()}k-=af;ae-=af;K-=ag;H.parent().append(b('<div class="jspCorner" />').css("width",ag+"px"));G();Q()}if(j){S.width(N.outerWidth()+"px")}R=U.outerHeight();n=R/ae;if(j){D=1/x*k;ac.width(D+"px");w=k-D}if(ad){v=1/n*L;O.height(v+"px");t=L-v}}function z(ag,af){return function(){X(ag,af);
this.blur();return false}}function X(ah,af){var ag=setInterval(function(){if(ah!=0){F(I+ah*aa.arrowButtonSpeed)}if(af!=0){E(m+af*aa.arrowButtonSpeed)}},aa.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(ag);b("html").unbind("mouseup.jsp")})}function u(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")}function E(af){if(af<0){af=0}else{if(af>t){af=t}}m=af;O.css("top",af);N.scrollTop(0);var ag=af/t;S.css("top",-ag*(R-ae))}function F(af){if(af<0){af=0}else{if(af>w){af=w}}I=af;ac.css("left",af);N.scrollTop(0);var ag=af/w;S.css("left",-ag*(Z-K))}function q(af){var ag=af/(R-ae);E(ag*t)}function Y(ah){var ak=b(ah),al=ak.outerHeight(),aj=0,af,ai,ag;while(!ak.is(".jspPane")){aj+=ak.position().top;ak=ak.offsetParent();if(/^body|html$/i.test(ak[0].nodeName)){return}}N.scrollTop(0);af=-S.position().top;ai=af+ae;if(aj<af){ag=aj-aa.verticalGutter}else{if(aj+al>ai){ag=aj-ae+al+aa.verticalGutter}}if(ag){q(ag)}}function i(){N.bind("mousewheel.jsp",function(af,ah){var ag=m;E(m-ah*aa.mouseWheelSpeed);return ag==m})}function J(){N.unbind("mousewheel.jsp")}function V(){return false}function p(){U.find(":input,a").bind("focus.jsp",function(){Y(this)})}function o(){U.find(":input,a").unbind("focus.jsp")}b.extend(g,{reinitialise:function(af){C(af)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);