/*
 * jScrollPane - v2.0.0beta1 - 2010-08-02
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(G,F){var q=this,t,I,r,v,z,C,m,J,l,w,i,g,D,p,h,o;t={};A(F);function A(K){var M,L;v=G.parent(".jspContainer");if(v.length==0){G.css("overflow","hidden");I=G.outerWidth();r=G.outerHeight();G.css("overflow","visible");G.wrap(b("<div />").addClass("jspContainer").css({width:I+"px",height:r+"px"}));v=G.parent()}else{I=v.outerWidth();r=v.outerHeight();v.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}G.css({width:"auto",height:"auto"});M=G.clone().css("position","absolute");L=b('<div style="width:1px; position: relative;" />').append(M);b("body").append(L);z=Math.max(G.outerWidth(),M.outerWidth());L.remove();C=G.outerHeight();m=z/I;J=C/r;l=J>0.99;w=m>1;if(!(w||l)){G.removeClass("jspScrollable");G.css("top",0);u()}else{G.addClass("jspScrollable");H();E()}}function H(){if(l){var Q,L,P,N,M,O,K;v.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));Q=v.find(">.jspVerticalBar");L=Q.find(">.jspTrack");i=L.find(">.jspDrag");P=Q.position().left>0?"right":"left";G.css("margin-"+P,(F.verticalGutter+L.outerWidth())+"px");C=G.outerHeight();J=C/r;if(F.showArrows){O=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",y(0,-1)).bind("click.jsp",n);K=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",y(0,1)).bind("click.jsp",n);L.before(O).after(K)}N=r;v.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){N-=b(this).outerHeight()});L.height(N+"px");M=1/J*N;i.height(M+"px");g=N-M;D=0;i.hover(function(){i.addClass("jspHover")},function(){i.removeClass("jspHover")}).bind("mousedown.jsp",function(S){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var R=S.pageY-i.position().top;b("html").bind("mousemove.jsp",function(T){j(T.pageY-R)}).bind("mouseup.jsp mouseleave.jsp",B);return false});x()}else{u()}}function E(){if(w){var O,N,K,M,P,Q,L;v.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));O=v.find(">.jspHorizontalBar");N=O.find(">.jspTrack");p=N.find(">.jspDrag");K=F.horizontalGutter+N.outerHeight();G.css("margin-bottom",K+"px");if(F.showArrows){Q=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",y(-1,0)).bind("click.jsp",n);L=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",y(1,0)).bind("click.jsp",n);N.before(Q).after(L)}M=v.innerWidth();v.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){M-=b(this).outerHeight()});N.width(M+"px");P=1/m*M;p.width(P+"px");h=M-P;o=0;p.hover(function(){p.addClass("jspHover")},function(){p.removeClass("jspHover")}).bind("mousedown.jsp",function(S){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var R=S.pageX-p.position().left;b("html").bind("mousemove.jsp",function(T){k(T.pageX-R)}).bind("mouseup.jsp mouseleave.jsp",B);return false})}else{}}function y(L,K){return function(){s(L,K);this.blur();return false}}function s(M,K){var L=setInterval(function(){if(M!=0){k(o+M*F.arrowButtonSpeed)}if(K!=0){j(D+K*F.arrowButtonSpeed)}},F.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(L);b("html").unbind("mouseup.jsp")})}function B(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")}function j(K){if(K<0){K=0}else{if(K>g){K=g}}D=K;i.css("top",K);v.scrollTop(0);var L=K/g;
G.css("top",-L*(C-r))}function k(K){if(K<0){K=0}else{if(K>h){K=h}}o=K;p.css("left",K);v.scrollTop(0);var L=K/h;G.css("left",-L*(z-I))}function x(){v.bind("mousewheel.jsp",function(K,M){var L=D;j(D-M*F.mouseWheelSpeed);return L==D})}function u(){v.unbind("mousewheel.jsp")}function n(){return false}b.extend(q,{reinitialise:function(K){A(K)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);