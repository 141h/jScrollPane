/*
 * jScrollPane - v2.0.0beta6 - 2010-10-28
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(c,Fa,P){c.fn.jScrollPane=function(I){function va(f,K){function ea(a){var b,d,g;e=a;if(h===P){f.css({overflow:"hidden",padding:0});m=f.innerWidth()+C;l=f.innerHeight();f.width(m);h=c('<div class="jspPane" />').wrap(c('<div class="jspContainer" />').css({width:m+"px",height:l+"px"}));f.wrapInner(h.parent());i=f.find(">.jspContainer");h=i.find(">.jspPane");h.css("padding",ma)}else{f.css("width","");if(a=f.outerWidth()+C!=m||f.outerHeight()!=l){m=f.innerWidth()+C;l=f.innerHeight();i.css({width:m+
"px",height:l+"px"})}if(!a&&na==D&&h.outerHeight()==w){if(x||y)f.css("width",m+C+"px");return}na=D;h.css("width","");f.css("width",m+"px");i.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}a=h.clone().css("position","absolute");b=c('<div style="width:1px; position: relative;" />').append(a);c("body").append(b);D=Math.max(h.outerWidth(),a.outerWidth());b.remove();w=h.outerHeight();fa=D/m;W=w/l;y=W>1;if((x=fa>1)||y){f.addClass("jspScrollable");if(a=e.maintainPosition&&(q||r)){d=-h.position().left;
g=-h.position().top}wa();xa();ya();if(a){X(d);L(g)}za();Aa();e.enableKeyboardNavigation&&Ba();e.clickOnTrack&&Ca();Da();e.hijackInternalLinks&&oa()}else{f.removeClass("jspScrollable");h.css({top:0,width:i.width()-C});i.unbind(ga);h.unbind("focusin.jsp");f.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keyup.jsp");pa();qa()}if(e.autoReinitialise&&!Y)Y=setInterval(function(){ea(e)},e.autoReinitialiseDelay);else!e.autoReinitialise&&Y&&clearInterval(Y);f.trigger("jsp-initialised",[x||
y])}function wa(){if(y){i.append(c('<div class="jspVerticalBar" />').append(c('<div class="jspCap jspCapTop" />'),c('<div class="jspTrack" />').append(c('<div class="jspDrag" />').append(c('<div class="jspDragTop" />'),c('<div class="jspDragBottom" />'))),c('<div class="jspCap jspCapBottom" />')));ha=i.find(">.jspVerticalBar");z=ha.find(">.jspTrack");t=z.find(">.jspDrag");if(e.showArrows){Q=c('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",E(0,-1)).bind("click.jsp",Z);R=c('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",
E(0,1)).bind("click.jsp",Z);if(e.arrowScrollOnHover){Q.bind("mouseover.jsp",E(0,-1,Q));R.bind("mouseover.jsp",E(0,1,R))}ra(z,e.verticalArrowPositions,Q,R)}M=l;i.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){M-=c(this).outerHeight()});t.hover(function(){t.addClass("jspHover")},function(){t.removeClass("jspHover")}).bind("mousedown.jsp",function(a){c("html").bind("dragstart.jsp selectstart.jsp",function(){return false});t.addClass("jspActive");var b=a.pageY-t.position().top;
c("html").bind("mousemove.jsp",function(d){N(d.pageY-b,false)}).bind("mouseup.jsp mouseleave.jsp",sa);return false});ta()}}function ta(){z.height(M+"px");q=0;ia=e.verticalGutter+z.outerWidth();h.width(m-ia-C);ha.position().left===0&&h.css("margin-left",ia+"px")}function xa(){if(x){i.append(c('<div class="jspHorizontalBar" />').append(c('<div class="jspCap jspCapLeft" />'),c('<div class="jspTrack" />').append(c('<div class="jspDrag" />').append(c('<div class="jspDragLeft" />'),c('<div class="jspDragRight" />'))),
c('<div class="jspCap jspCapRight" />')));ja=i.find(">.jspHorizontalBar");A=ja.find(">.jspTrack");u=A.find(">.jspDrag");if(e.showArrows){S=c('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",E(-1,0)).bind("click.jsp",Z);T=c('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",E(1,0)).bind("click.jsp",Z);if(e.arrowScrollOnHover){S.bind("mouseover.jsp",E(-1,0,S));T.bind("mouseover.jsp",E(1,0,T))}ra(A,e.horizontalArrowPositions,S,T)}u.hover(function(){u.addClass("jspHover")},function(){u.removeClass("jspHover")}).bind("mousedown.jsp",
function(a){c("html").bind("dragstart.jsp selectstart.jsp",function(){return false});u.addClass("jspActive");var b=a.pageX-u.position().left;c("html").bind("mousemove.jsp",function(d){U(d.pageX-b,false)}).bind("mouseup.jsp mouseleave.jsp",sa);return false});J=i.innerWidth();ua()}}function ua(){i.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){J-=c(this).outerWidth()});A.width(J+"px");r=0}function ya(){if(x&&y){var a=A.outerHeight(),b=z.outerWidth();M-=a;c(ja).find(">.jspCap:visible,>.jspArrow").each(function(){J+=
c(this).outerWidth()});J-=b;l-=b;m-=a;A.parent().append(c('<div class="jspCorner" />').css("width",a+"px"));ta();ua()}x&&h.width(i.outerWidth()-C+"px");w=h.outerHeight();W=w/l;if(x){F=1/fa*J;if(F>e.horizontalDragMaxWidth)F=e.horizontalDragMaxWidth;else if(F<e.horizontalDragMinWidth)F=e.horizontalDragMinWidth;u.width(F+"px");G=J-F;ka(r)}if(y){H=1/W*M;if(H>e.verticalDragMaxHeight)H=e.verticalDragMaxHeight;else if(H<e.verticalDragMinHeight)H=e.verticalDragMinHeight;t.height(H+"px");B=M-H;la(q)}}function ra(a,
b,d,g){var j="before",k="after";if(b=="os")b=/Mac/.test(navigator.platform)?"after":"split";if(b==j)k=b;else if(b==k){j=b;b=d;d=g;g=b}a[j](d)[k](g)}function E(a,b,d){return function(){Ea(a,b,this,d);this.blur();return false}}function Ea(a,b,d,g){function j(){p=setTimeout(j,e.arrowRepeatFreq*(s?3:1));s=false;a!==0&&n.scrollByX(a*e.arrowButtonSpeed);b!==0&&n.scrollByY(b*e.arrowButtonSpeed)}d=c(d).addClass("jspActive");var k,p,s=true;j();k=g?"mouseout.jsp":"mouseup.jsp";g=g||c("html");g.bind(k,function(){d.removeClass("jspActive");
if(p){clearTimeout(p);p=null}g.unbind(k);f.focus()})}function Ca(){pa();y&&z.bind("mousedown.jsp",function(a){if(!a.originalTarget||a.originalTarget==a.currentTarget){var b=c(this),d=b.offset(),g=a.pageY-d.top-q,j,k=true,p=function(){j=setTimeout(p,e.trackClickRepeatFreq*(k?3:1));k=false;var o=b.offset();o=a.pageY-o.top-H/2;var v=l*e.scrollPagePercent,O=B*v/(w-l);if(g<0)q-O>o?n.scrollByY(-v):N(o);else if(g>0)q+O<o?n.scrollByY(v):N(o);else s()},s=function(){if(j){clearTimeout(j);j=null}c(document).unbind("mouseup.jsp",
s);f.focus()};p();c(document).bind("mouseup.jsp",s);return false}});x&&A.bind("mousedown.jsp",function(a){if(!a.originalTarget||a.originalTarget==a.currentTarget){var b=c(this),d=b.offset(),g=a.pageX-d.left-r,j,k=true,p=function(){j=setTimeout(p,e.trackClickRepeatFreq*(k?3:1));k=false;var o=b.offset();o=a.pageX-o.left-F/2;var v=m*e.scrollPagePercent,O=G*v/(D-m);if(g<0)r-O>o?n.scrollByX(-v):U(o);else if(g>0)r+O<o?n.scrollByX(v):U(o);else s()},s=function(){if(j){clearTimeout(j);j=null}c(document).unbind("mouseup.jsp",
s);f.focus()};p();c(document).bind("mouseup.jsp",s);return false}})}function pa(){A&&A.unbind("mousedown.jsp");z&&z.unbind("mousedown.jsp")}function sa(){c("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");t&&t.removeClass("jspActive");u&&u.removeClass("jspActive");f.focus()}function N(a,b){if(y){if(a<0)a=0;else if(a>B)a=B;if(b===P)b=e.animateScroll;if(b)n.animate(t,"top",a,la);else{t.css("top",a);la(a)}}}function la(a){if(a===P)a=t.position().top;i.scrollTop(0);
q=a;var b=q===0,d=q==B;a=-(a/B)*(w-l);if($!=b||aa!=d){$=b;aa=d;f.trigger("jsp-arrow-change",[$,aa,ba,ca])}if(e.showArrows){Q[b?"addClass":"removeClass"]("jspDisabled");R[d?"addClass":"removeClass"]("jspDisabled")}h.css("top",a);f.trigger("jsp-scroll-y",[-a,b,d])}function U(a,b){if(x){if(a<0)a=0;else if(a>G)a=G;if(b===P)b=e.animateScroll;if(b)n.animate(u,"left",a,ka);else{u.css("left",a);ka(a)}}}function ka(a){if(a===P)a=u.position().left;i.scrollTop(0);r=a;var b=r===0,d=r==G;a=-(a/G)*(D-m);if(ba!=
b||ca!=d){ba=b;ca=d;f.trigger("jsp-arrow-change",[$,aa,ba,ca])}if(e.showArrows){S[b?"addClass":"removeClass"]("jspDisabled");T[d?"addClass":"removeClass"]("jspDisabled")}h.css("left",a);f.trigger("jsp-scroll-x",[-a,b,d])}function L(a,b){N(a/(w-l)*B,b)}function X(a,b){U(a/(D-m)*G,b)}function V(a,b,d){var g,j,k=0,p=0,s,o,v;try{g=c(a)}catch(O){return}j=g.outerHeight();a=g.outerWidth();i.scrollTop(0);for(i.scrollLeft(0);!g.is(".jspPane");){k+=g.position().top;p+=g.position().left;g=g.offsetParent();if(/^body|html$/i.test(g[0].nodeName))return}g=
-h.position().top;s=g+l;if(k<g||b)o=k-e.verticalGutter;else if(k+j>s)o=k-l+j+e.verticalGutter;o&&L(o,d);viewportLeft=-h.position().left;k=viewportLeft+m;if(p<viewportLeft||b)v=p-e.horizontalGutter;else if(p+a>k)v=p-m+a+e.horizontalGutter;v&&X(v,d)}function Aa(){i.unbind(ga).bind(ga,function(a,b,d,g){a=r;b=q;n.scrollBy(-d*e.mouseWheelSpeed,-g*e.mouseWheelSpeed);return a==r&&b==q})}function Z(){return false}function za(){h.unbind("focusin.jsp").bind("focusin.jsp",function(a){a.target!==this&&V(a.target,
false)})}function Ba(){f.attr("tabindex",0).unbind("keydown.jsp keyup.jsp").bind("keydown.jsp",function(a){if(a.target===this){var b=r,d=q;switch(a.keyCode){case 40:n.scrollByY(e.keyboardSpeed);break;case 38:n.scrollByY(-e.keyboardSpeed);break;case 34:case 32:n.scrollByY(l*e.scrollPagePercent);break;case 33:n.scrollByY(-l*e.scrollPagePercent);break;case 35:L(w-l);break;case 36:L(0);break;case 39:n.scrollByX(e.keyboardSpeed);break;case 37:n.scrollByX(-e.keyboardSpeed)}if(b!=r||d!=q)return false}});
if(e.hideFocus){f.css("outline","none");"hideFocus"in i[0]&&f.attr("hideFocus",true)}else{f.css("outline","");"hideFocus"in i[0]&&f.attr("hideFocus",false)}}function Da(){if(location.hash&&location.hash.length>1){var a,b;try{a=c(location.hash)}catch(d){return}if(a.length&&h.find(a))if(i.scrollTop()===0)b=setInterval(function(){if(i.scrollTop()>0){V(location.hash,true);c(document).scrollTop(i.position().top);clearInterval(b)}},50);else{V(location.hash,true);c(document).scrollTop(i.position().top)}}}
function qa(){c("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function oa(){qa();c("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var a=this.href.split("#");if(a.length>1){a=a[1];if(a.length>0&&h.find("#"+a).length>0){V("#"+a,true);return false}}})}var e,n=this,h,m,l,i,D,w,fa,W,y,x,t,B,q,u,G,r,ha,z,ia,M,H,Q,R,ja,A,J,F,S,T,Y,ma,C,na,$=true,ba=true,aa=false,ca=false,ga=c.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";ma=f.css("paddingTop")+" "+f.css("paddingRight")+
" "+f.css("paddingBottom")+" "+f.css("paddingLeft");C=(parseInt(f.css("paddingLeft"),10)||0)+(parseInt(f.css("paddingRight"),10)||0);c.extend(n,{reinitialise:function(a){a=c.extend({},a,e);ea(a)},scrollToElement:function(a,b,d){V(a,b,d)},scrollTo:function(a,b,d){X(a,d);L(b,d)},scrollToX:function(a,b){X(a,b)},scrollToY:function(a,b){L(a,b)},scrollBy:function(a,b,d){n.scrollByX(a,d);n.scrollByY(b,d)},scrollByX:function(a,b){var d=(-h.position().left+a)/(D-m);U(d*G,b)},scrollByY:function(a,b){var d=
(-h.position().top+a)/(w-l);N(d*B,b)},animate:function(a,b,d,g){var j={};j[b]=d;a.animate(j,{duration:e.animateDuration,ease:e.animateEase,queue:false,step:g})},getContentPositionX:function(){return-h.position().left},getContentPositionY:function(){return-h.position().top},getIsScrollableH:function(){return x},getIsScrollableV:function(){return y},getContentPane:function(){return h},scrollToBottom:function(a){N(B,a)},hijackInternalLinks:function(){oa()}});ea(K)}I=c.extend({},c.fn.jScrollPane.defaults,
I);c.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){I[this]=I[this]||I.speed});var da;this.each(function(){var f=c(this),K=f.data("jsp");if(K)K.reinitialise(I);else{K=new va(f,I);f.data("jsp",K)}da=da?da.add(f):f});return da};c.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,
animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,speed:30,scrollPagePercent:0.8}})(jQuery,this);
