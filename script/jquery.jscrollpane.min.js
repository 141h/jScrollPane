/*
 * jScrollPane - v2.0.0beta1 - 2010-08-02
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(E,D){var p=this;var G,q,t,x,A,m,H,l,u,i,g,B,o,h,n;savedSettings={};y(D);function y(I){t=E.parent(".jspContainer");if(t.length==0){E.css("overflow","hidden");G=E.innerWidth();q=E.innerHeight();E.css("overflow","visible");E.wrap(b("<div />").addClass("jspContainer").css({width:G+"px",height:q+"px"}));t=E.parent()}else{G=t.outerWidth();q=t.outerHeight();t.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}E.css({width:"auto",height:"auto"});var K=E.clone().css("position","absolute");var J=b('<div style="width:1px; position: relative;" />').append(K);b("body").append(J);x=Math.max(E.outerWidth(),K.outerWidth());J.remove();A=E.outerHeight();m=x/G;H=A/q;l=H>0.99;u=m>1;if(!(u||l)){E.removeClass("jspScrollable");E.css("top",0);s()}else{E.addClass("jspScrollable");F();C()}}function F(){if(l){t.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));var O=t.find(">.jspVerticalBar");var J=O.find(">.jspTrack");i=J.find(">.jspDrag");var N=O.position().left>0?"right":"left";E.css("margin-"+N,(D.verticalGutter+J.outerWidth())+"px");A=E.outerHeight();H=A/q;if(D.showArrows){var M=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",w(0,-1));var I=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",w(0,1));J.before(M).after(I)}var L=q;t.find(">.jspVerticalBar>.jspCap,>.jspVerticalBar>.jspArrow").each(function(){L-=b(this).outerHeight()});J.height(L+"px");var K=1/H*L;i.height(K+"px");g=L-K;B=0;i.hover(function(){i.addClass("jspHover")},function(){i.removeClass("jspHover")}).bind("mousedown.jsp",function(Q){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var P=Q.pageY-i.position().top;b("html").bind("mousemove.jsp",function(R){j(R.pageY-P)}).bind("mouseup.jsp mouseleave.jsp",z);return false});v()}else{s()}}function C(){if(u){t.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));var M=t.find(">.jspHorizontalBar");var L=M.find(">.jspTrack");o=L.find(">.jspDrag");var I=D.horizontalGutter+L.outerHeight();E.css("margin-bottom",I+"px");if(D.showArrows){var O=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",w(-1,0));var J=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",w(1,0));L.before(O).after(J)}var K=t.innerWidth();t.find(">.jspHorizontalBar>.jspCap,>.jspHorizontalBar>.jspArrow").each(function(){K-=b(this).outerHeight()});L.width(K+"px");var N=1/m*K;o.width(N+"px");h=K-N;n=0;o.hover(function(){o.addClass("jspHover")},function(){o.removeClass("jspHover")}).bind("mousedown.jsp",function(Q){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var P=Q.pageX-o.position().left;b("html").bind("mousemove.jsp",function(R){k(R.pageX-P)}).bind("mouseup.jsp mouseleave.jsp",z);return false})}else{}}function w(J,I){return function(){r(J,I);this.blur();return false}}function r(K,I){var J=setInterval(function(){if(K!=0){k(n+K*D.arrowButtonSpeed)}if(I!=0){j(B+I*D.arrowButtonSpeed)}},D.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(J);b("html").unbind("mouseup.jsp")})}function z(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")}function j(I){if(I<0){I=0}else{if(I>g){I=g}}B=I;i.css("top",I);t.scrollTop(0);var J=I/g;E.css("top",-J*(A-q))}function k(I){if(I<0){I=0}else{if(I>h){I=h}}n=I;o.css("left",I);t.scrollTop(0);var J=I/h;E.css("left",-J*(x-G))}function v(){t.bind("mousewheel.jsp",function(I,K){var J=B;j(B-K*D.mouseWheelSpeed);return J==B})}function s(){t.unbind("mousewheel.jsp")}b.extend(p,{reinitialise:function(I){y(I)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this);var h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);