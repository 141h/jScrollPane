/*
 * jScrollPane - v2.0.0beta1 - 2010-08-06
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(af,ad){var ak,h=this,ac,I,R,ap,V,aj,ab,E,q,an,m,W,A,p,am,D,P,ae,U,o,S,C,Z,F,H,O,n,K,y,al,z;I={};J(ad);function J(at){var ay,ax,aw,au,av,ar,aq;ak=at;if(ac==c){af.css("overflow","hidden");R=af.innerWidth();ap=af.innerHeight();ac=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:R+"px",height:ap+"px"}));af.css("overflow","visible");af.wrap(ac.parent());ac=af.parent();V=ac.parent();aw=af.find(":first-child");au=af.find(":last-child");V.css({"margin-top":aw.css("margin-top"),"margin-bottom":au.css("margin-bottom")});aw.css("margin-top",0);au.css("margin-bottom",0)}else{if(af.outerWidth()==aj&&af.outerHeight()==ab){return}R=V.outerWidth();ap=V.outerHeight();V.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}af.css({width:"auto",height:"auto"});ay=af.clone().css("position","absolute");ax=b('<div style="width:1px; position: relative;" />').append(ay);b("body").append(ax);aj=Math.max(af.outerWidth(),ay.outerWidth());ax.remove();ab=af.outerHeight();E=aj/R;q=ab/ap;an=q>1;m=E>1;if(!(m||an)){af.removeClass("jspScrollable");ac.css("top",0);Q();r();u()}else{af.addClass("jspScrollable");av=ak.maintainPosition&&(p||P);if(av){ar=j();aq=g()}x();ah();k();if(av){w(ar);v(aq)}t();ao();if(ak.hijackInternalLinks){i()}}if(ak.autoReinitialise&&!z){z=setInterval(function(){J(ak)},ak.autoReinitialiseDelay)}else{if(!ak.autoReinitialise&&z){clearInterval(z)}}}function x(){if(an){V.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));ae=V.find(">.jspVerticalBar");U=ae.find(">.jspTrack");W=U.find(">.jspDrag");if(ak.showArrows){Z=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",G(0,-1)).bind("click.jsp",ag);F=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",G(0,1)).bind("click.jsp",ag);U.before(Z).after(F)}S=ap;V.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){S-=b(this).outerHeight()});W.hover(function(){W.addClass("jspHover")},function(){W.removeClass("jspHover")}).bind("mousedown.jsp",function(aq){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});W.addClass("jspActive");var s=aq.pageY-W.position().top;b("html").bind("mousemove.jsp",function(ar){L(ar.pageY-s,false)}).bind("mouseup.jsp mouseleave.jsp",B);return false});N();l()}else{Q()}}function N(){U.height(S+"px");p=0;o=ak.verticalGutter+U.outerWidth();ac.width(R-o);if(ae.position().left==0){ac.css("margin-left",o+"px")}}function ah(){if(m){V.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));H=V.find(">.jspHorizontalBar");O=H.find(">.jspTrack");am=O.find(">.jspDrag");if(ak.showArrows){y=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",G(-1,0)).bind("click.jsp",ag);al=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",G(1,0)).bind("click.jsp",ag);O.before(y).after(al)}am.hover(function(){am.addClass("jspHover")},function(){am.removeClass("jspHover")}).bind("mousedown.jsp",function(aq){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var s=aq.pageX-am.position().left;b("html").bind("mousemove.jsp",function(ar){M(ar.pageX-s,false)}).bind("mouseup.jsp mouseleave.jsp",B);return false});n=V.innerWidth();aa()}else{}}function aa(){ac.height(ap-ak.horizontalGutter-O.outerHeight());V.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){n-=b(this).outerWidth()
});O.width(n+"px");P=0}function k(){if(m&&an){var aq=O.outerHeight(),s=U.outerWidth();S-=aq;b(H).find(">.jspCap:visible,>.jspArrow").each(function(){n+=b(this).outerWidth()});n-=s;ap-=s;R-=aq;O.parent().append(b('<div class="jspCorner" />').css("width",aq+"px"));N();aa()}if(m){ac.width(V.outerWidth()+"px")}ab=af.outerHeight();q=ab/ap;if(m){K=1/E*n;if(K>ak.horizontalDragMaxWidth){K=ak.horizontalDragMaxWidth}else{if(K<ak.horizontalDragMinWidth){K=ak.horizontalDragMinWidth}}am.width(K+"px");D=n-K}if(an){C=1/q*S;if(C>ak.verticalDragMaxHeight){C=ak.verticalDragMaxHeight}else{if(C<ak.verticalDragMinHeight){C=ak.verticalDragMinHeight}}W.height(C+"px");A=S-C}}function G(aq,s){return function(){ai(aq,s,this);this.blur();return false}}function ai(ar,s,at){at=b(at).addClass("jspActive");var aq=setInterval(function(){if(ar!=0){M(P+ar*ak.arrowButtonSpeed,false)}if(s!=0){L(p+s*ak.arrowButtonSpeed,false)}},ak.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){at.removeClass("jspActive");clearInterval(aq);b("html").unbind("mouseup.jsp")})}function B(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");W&&W.removeClass("jspActive");am&&am.removeClass("jspActive")}function L(s,aq){if(!an){return}if(s<0){s=0}else{if(s>A){s=A}}if(aq==c){aq=ak.animateScroll}if(aq){h.animate(W,"top",s,X)}else{W.css("top",s);X(s)}}function X(aq){if(aq==c){aq=W.position().top}V.scrollTop(0);p=aq;var ar=aq/A,s=-ar*(ab-ap);ac.css("top",s)}function M(aq,s){if(!m){return}if(aq<0){aq=0}else{if(aq>D){aq=D}}if(s==c){s=ak.animateScroll}if(s){h.animate(am,"left",aq,Y)}else{am.css("left",aq);Y(aq)}}function Y(aq){if(aq==c){aq=am.position().left}V.scrollTop(0);P=aq;var ar=aq/D,s=-ar*(aj-R);ac.css("left",s)}function v(s,aq){var ar=s/(ab-ap);L(ar*A,aq)}function w(aq,s){var ar=aq/(aj-R);M(ar*D,s)}function T(az,ax,aq){var av,at,s=0,ar,aw,ay;try{av=b(az)}catch(au){return}at=av.outerHeight();V.scrollTop(0);while(!av.is(".jspPane")){s+=av.position().top;av=av.offsetParent();if(/^body|html$/i.test(av[0].nodeName)){return}}ar=g();aw=ar+ap;if(s<ar||ax){ay=s-ak.verticalGutter}else{if(s+at>aw){ay=s-ap+at+ak.verticalGutter}}if(ay){v(ay,aq)}}function j(){return -ac.position().left}function g(){return -ac.position().top}function l(){V.unbind("mousewheel.jsp").bind("mousewheel.jsp",function(s,ar){var aq=p;L(p-ar*ak.mouseWheelSpeed,false);return aq==p})}function Q(){V.unbind("mousewheel.jsp")}function ag(){return false}function t(){af.find(":input,a").bind("focus.jsp",function(){T(this,false)})}function r(){af.find(":input,a").unbind("focus.jsp")}function ao(){if(location.hash&&location.hash.length>1){var ar,aq;try{ar=b(location.hash)}catch(s){return}if(ar.length&&af.find(ar)){if(V.scrollTop()==0){aq=setInterval(function(){if(V.scrollTop()>0){T(location.hash,true);b(document).scrollTop(V.position().top);clearInterval(aq)}},50)}else{T(location.hash,true);b(document).scrollTop(V.position().top)}}}}function u(){b("a[href^=#]").unbind("click.jsp-hijack")}function i(){b("a[href^=#]").unbind("click.jsp-hijack").bind("click.jsp-hijack",function(){var s=this.href.split("#"),aq;if(s.length>1){aq=s[1];if(aq.length>0&&af.find("#"+aq).length>0){T("#"+aq,true);return false}}})}b.extend(h,{reinitialise:function(aq){aq=b.extend({},aq,ak);J(aq)},scrollToElement:function(ar,aq,s){T(ar,aq,s)},scrollTo:function(ar,s,aq){w(ar,aq);v(s,aq)},scrollToX:function(aq,s){w(aq,s)},scrollToY:function(s,aq){v(s,aq)},scrollBy:function(aq,s,ar){h.scrollByX(aq,ar);h.scrollByY(s,ar)},scrollByX:function(s,ar){var aq=j()+s,at=aq/(aj-R);M(at*D,ar)},scrollByY:function(s,ar){var aq=g()+s,at=aq/(ab-ap);L(at*A,ar)},animate:function(aq,au,s,at){var ar={};ar[au]=s;aq.animate(ar,{duration:ak.animateDuration,ease:ak.animateEase,queue:false,step:at})},getContentPositionX:function(){return j()},getContentPositionY:function(){return g()},scrollToBottom:function(s){L(A,s)},hijackInternalLinks:function(){i()}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");
if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);