/*
 * jScrollPane - v2.0.0beta4 - 2010-09-17
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(D,M){var aw,O=this,W,ai,w,ak,R,X,z,r,ax,aD,ar,n,i,I,h,an,j,Y,S,am,V,u,B,ao,ad,al,G,l,aq,av,y,at,aG,g,aC,ah=true,N=true,aF=false,k=false,aa=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";aG=D.css("paddingTop")+" "+D.css("paddingRight")+" "+D.css("paddingBottom")+" "+D.css("paddingLeft");g=(parseInt(D.css("paddingLeft"))||0)+(parseInt(D.css("paddingRight"))||0);ap(M);function ap(aJ){var aN,aM,aL,aI,aH,aK;aw=aJ;if(W==c){D.css({overflow:"hidden",padding:0});ai=D.innerWidth()+g;w=D.innerHeight();D.width(ai);W=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:ai+"px",height:w+"px"}));D.wrapInner(W.parent());ak=D.find(">.jspContainer");W=ak.find(">.jspPane");W.css("padding",aG)}else{D.css("width",null);aK=D.outerWidth()+g!=ai||D.outerHeight()!=w;if(aK){ai=D.innerWidth()+g;w=D.innerHeight();ak.css({width:ai+"px",height:w+"px"})}aC=W.innerWidth();if(!aK&&W.outerWidth()==R&&W.outerHeight()==X){if(aD||ax){W.css("width",aC+"px");D.css("width",(aC+g)+"px")}return}W.css("width",null);D.css("width",(ai)+"px");ak.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}aN=W.clone().css("position","absolute");aM=b('<div style="width:1px; position: relative;" />').append(aN);b("body").append(aM);R=Math.max(W.outerWidth(),aN.outerWidth());aM.remove();X=W.outerHeight();z=R/ai;r=X/w;ax=r>1;aD=z>1;if(!(aD||ax)){D.removeClass("jspScrollable");W.css({top:0,width:null});o();E();P();x();ag()}else{D.addClass("jspScrollable");aL=aw.maintainPosition&&(I||Y);if(aL){aI=aA();aH=ay()}aE();A();F();if(aL){L(aI);K(aH)}J();ae();if(aw.enableKeyboardNavigation){Q()}if(aw.clickOnTrack){q()}C();if(aw.hijackInternalLinks){m()}}if(aw.autoReinitialise&&!at){at=setInterval(function(){ap(aw)},aw.autoReinitialiseDelay)}else{if(!aw.autoReinitialise&&at){clearInterval(at)}}D.trigger("jsp-initialised",[aD||ax])}function aE(){if(ax){ak.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragStretch" />').append(b('<div class="jspDragCenter" />')),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));S=ak.find(">.jspVerticalBar");am=S.find(">.jspTrack");ar=am.find(">.jspDrag");n=ar.find(">.jspDragStretch");if(aw.showArrows){ao=b('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",aB(0,-1)).bind("click.jsp",az);ad=b('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",aB(0,1)).bind("click.jsp",az);if(aw.arrowScrollOnHover){ao.bind("mouseover.jsp",aB(0,-1,ao));ad.bind("mouseover.jsp",aB(0,1,ad))}aj(am,aw.verticalArrowPositions,ao,ad)}u=w;ak.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){u-=b(this).outerHeight()});ar.hover(function(){ar.addClass("jspHover")},function(){ar.removeClass("jspHover")}).bind("mousedown.jsp",function(aH){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});ar.addClass("jspActive");var s=aH.pageY-ar.position().top;b("html").bind("mousemove.jsp",function(aI){T(aI.pageY-s,false)}).bind("mouseup.jsp mouseleave.jsp",au);return false});p()}}function p(){am.height(u+"px");I=0;V=aw.verticalGutter+am.outerWidth();W.width(ai-V-g);if(S.position().left==0){W.css("margin-left",V+"px")}}function A(){if(aD){ak.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragStretch" />').append(b('<div class="jspDragCenter" />')),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));al=ak.find(">.jspHorizontalBar");G=al.find(">.jspTrack");h=G.find(">.jspDrag");an=h.find(">.jspDragStretch");
if(aw.showArrows){av=b('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",aB(-1,0)).bind("click.jsp",az);y=b('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",aB(1,0)).bind("click.jsp",az);if(aw.arrowScrollOnHover){av.bind("mouseover.jsp",aB(-1,0,av));y.bind("mouseover.jsp",aB(1,0,y))}aj(G,aw.horizontalArrowPositions,av,y)}h.hover(function(){h.addClass("jspHover")},function(){h.removeClass("jspHover")}).bind("mousedown.jsp",function(aH){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});h.addClass("jspActive");var s=aH.pageX-h.position().left;b("html").bind("mousemove.jsp",function(aI){U(aI.pageX-s,false)}).bind("mouseup.jsp mouseleave.jsp",au);return false});l=ak.innerWidth();af()}else{}}function af(){ak.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){l-=b(this).outerWidth()});Y=0}function F(){var aJ,s,aH,aI;if(aD&&ax){aJ=G.outerHeight();s=am.outerWidth();u-=aJ;b(al).find(">.jspCap:visible,>.jspArrow").each(function(){l+=b(this).outerWidth()});l-=s;w-=s;ai-=aJ;G.parent().append(b('<div class="jspCorner" />').css("width",aJ+"px"));p();af()}if(aD){W.width((ak.outerWidth()-g)+"px")}X=W.outerHeight();r=X/w;if(aD){aq=1/z*l;if(aq>aw.horizontalDragMaxWidth){aq=aw.horizontalDragMaxWidth}else{if(aq<aw.horizontalDragMinWidth){aq=aw.horizontalDragMinWidth}}h.width(aq+"px");aH=aq;h.find(">.jspDragLeft,>.jspDragRight").each(function(){aH-=b(this).outerWidth()});an.width(aH+"px");j=l-aq;ac(Y)}if(ax){B=1/r*u;if(B>aw.verticalDragMaxHeight){B=aw.verticalDragMaxHeight}else{if(B<aw.verticalDragMinHeight){B=aw.verticalDragMinHeight}}ar.height(B+"px");aI=B;ar.find(">.jspDragTop,>.jspDragBottom").each(function(){aI-=b(this).outerHeight()});n.height(aI+"px");i=u-B;ab(I)}}function aj(aI,aK,aH,s){var aM="before",aJ="after",aL;if(aK=="os"){aK=/Mac/.test(navigator.platform)?"after":"split"}if(aK==aM){aJ=aK}else{if(aK==aJ){aM=aK;aL=aH;aH=s;s=aL}}aI[aM](aH)[aJ](s)}function aB(aH,s,aI){return function(){H(aH,s,this,aI);this.blur();return false}}function H(aJ,aH,aM,aL){aM=b(aM).addClass("jspActive");var aK,s=function(){if(aJ!=0){U(Y+aJ*aw.arrowButtonSpeed,false)}if(aH!=0){T(I+aH*aw.arrowButtonSpeed,false)}},aI=setInterval(s,aw.arrowRepeatFreq);s();aK=aL==c?"mouseup.jsp":"mouseout.jsp";aL=aL||b("html");aL.bind(aK,function(){aM.removeClass("jspActive");clearInterval(aI);aL.unbind(aK)})}function q(){x();if(ax){am.bind("mousedown.jsp",function(aJ){if(aJ.originalTarget==c||aJ.originalTarget==aJ.currentTarget){var aI=b(this),s=setInterval(function(){var aK=aI.offset(),aL=aJ.pageY-aK.top;if(I+B<aL){T(I+aw.trackClickSpeed)}else{if(aL<I){T(I-aw.trackClickSpeed)}else{aH()}}},aw.trackClickRepeatFreq),aH=function(){s&&clearInterval(s);s=null;b(document).unbind("mouseup.jsp",aH)};b(document).bind("mouseup.jsp",aH);return false}})}if(aD){G.bind("mousedown.jsp",function(aJ){if(aJ.originalTarget==c||aJ.originalTarget==aJ.currentTarget){var aI=b(this),s=setInterval(function(){var aK=aI.offset(),aL=aJ.pageX-aK.left;if(Y+aq<aL){U(Y+aw.trackClickSpeed)}else{if(aL<Y){U(Y-aw.trackClickSpeed)}else{aH()}}},aw.trackClickRepeatFreq),aH=function(){s&&clearInterval(s);s=null;b(document).unbind("mouseup.jsp",aH)};b(document).bind("mouseup.jsp",aH);return false}})}}function x(){G&&G.unbind("mousedown.jsp");am&&am.unbind("mousedown.jsp")}function au(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");ar&&ar.removeClass("jspActive");h&&h.removeClass("jspActive")}function T(s,aH){if(!ax){return}if(s<0){s=0}else{if(s>i){s=i}}if(aH==c){aH=aw.animateScroll}if(aH){O.animate(ar,"top",s,ab)}else{ar.css("top",s);ab(s)}}function ab(aH){if(aH==c){aH=ar.position().top}ak.scrollTop(0);I=aH;var aK=I==0,aI=I==i,aJ=aH/i,s=-aJ*(X-w);if(ah!=aK||aF!=aI){ah=aK;aF=aI;D.trigger("jsp-arrow-change",[ah,aF,N,k])}v(aK,aI);W.css("top",s);D.trigger("jsp-scroll-y",[-s,aK,aI])}function U(aH,s){if(!aD){return}if(aH<0){aH=0}else{if(aH>j){aH=j}}if(s==c){s=aw.animateScroll}if(s){O.animate(h,"left",aH,ac)
}else{h.css("left",aH);ac(aH)}}function ac(aH){if(aH==c){aH=h.position().left}ak.scrollTop(0);Y=aH;var aK=Y==0,aJ=Y==j,aI=aH/j,s=-aI*(R-ai);if(N!=aK||k!=aJ){N=aK;k=aJ;D.trigger("jsp-arrow-change",[ah,aF,N,k])}t(aK,aJ);W.css("left",s);D.trigger("jsp-scroll-x",[-s,aK,aJ])}function v(aH,s){if(aw.showArrows){ao[aH?"addClass":"removeClass"]("jspDisabled");ad[s?"addClass":"removeClass"]("jspDisabled")}}function t(aH,s){if(aw.showArrows){av[aH?"addClass":"removeClass"]("jspDisabled");y[s?"addClass":"removeClass"]("jspDisabled")}}function K(s,aH){var aI=s/(X-w);T(aI*i,aH)}function L(aH,s){var aI=aH/(R-ai);U(aI*j,s)}function Z(aP,aN,aH){var aL,aJ,s=0,aI,aM,aO;try{aL=b(aP)}catch(aK){return}aJ=aL.outerHeight();ak.scrollTop(0);while(!aL.is(".jspPane")){s+=aL.position().top;aL=aL.offsetParent();if(/^body|html$/i.test(aL[0].nodeName)){return}}aI=ay();aM=aI+w;if(s<aI||aN){aO=s-aw.verticalGutter}else{if(s+aJ>aM){aO=s-w+aJ+aw.verticalGutter}}if(aO){K(aO,aH)}}function aA(){return -W.position().left}function ay(){return -W.position().top}function ae(){ak.unbind(aa).bind(aa,function(aK,aL,aJ,aH){var aI=Y,s=I;U(Y+aJ*aw.mouseWheelSpeed,false);T(I-aH*aw.mouseWheelSpeed,false);return aI==Y&&s==I})}function o(){ak.unbind(aa)}function az(){return false}function J(){W.unbind("focusin.jsp").bind("focusin.jsp",function(s){if(s.target===W[0]){return}Z(s.target,false)})}function E(){W.unbind("focusin.jsp")}function Q(){var aH,s;D.attr("tabindex",0).unbind("keydown.jsp").bind("keydown.jsp",function(aL){if(aL.target!==D[0]){return}var aJ=Y,aI=I,aK=aH?2:16;switch(aL.keyCode){case 40:T(I+aK,false);break;case 38:T(I-aK,false);break;case 34:case 32:K(ay()+Math.max(32,w)-16);break;case 33:K(ay()-w+16);break;case 35:K(X-w);break;case 36:K(0);break;case 39:U(Y+aK,false);break;case 37:U(Y-aK,false);break}if(!(aJ==Y&&aI==I)){aH=true;clearTimeout(s);s=setTimeout(function(){aH=false},260);return false}});if(aw.hideFocus){D.css("outline","none");if("hideFocus" in ak[0]){D.attr("hideFocus",true)}}else{D.css("outline","");if("hideFocus" in ak[0]){D.attr("hideFocus",false)}}}function P(){D.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp")}function C(){if(location.hash&&location.hash.length>1){var aI,aH;try{aI=b(location.hash)}catch(s){return}if(aI.length&&W.find(aI)){if(ak.scrollTop()==0){aH=setInterval(function(){if(ak.scrollTop()>0){Z(location.hash,true);b(document).scrollTop(ak.position().top);clearInterval(aH)}},50)}else{Z(location.hash,true);b(document).scrollTop(ak.position().top)}}}}function ag(){b("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function m(){ag();b("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var s=this.href.split("#"),aH;if(s.length>1){aH=s[1];if(aH.length>0&&W.find("#"+aH).length>0){Z("#"+aH,true);return false}}})}b.extend(O,{reinitialise:function(aH){aH=b.extend({},aH,aw);ap(aH)},scrollToElement:function(aI,aH,s){Z(aI,aH,s)},scrollTo:function(aI,s,aH){L(aI,aH);K(s,aH)},scrollToX:function(aH,s){L(aH,s)},scrollToY:function(s,aH){K(s,aH)},scrollBy:function(aH,s,aI){O.scrollByX(aH,aI);O.scrollByY(s,aI)},scrollByX:function(s,aI){var aH=aA()+s,aJ=aH/(R-ai);U(aJ*j,aI)},scrollByY:function(s,aI){var aH=ay()+s,aJ=aH/(X-w);T(aJ*i,aI)},animate:function(aH,aK,s,aJ){var aI={};aI[aK]=s;aH.animate(aI,{duration:aw.animateDuration,ease:aw.animateEase,queue:false,step:aJ})},getContentPositionX:function(){return aA()},getContentPositionY:function(){return ay()},getIsScrollableH:function(){return aD},getIsScrollableV:function(){return ax},getContentPane:function(){return W},scrollToBottom:function(s){T(i,s)},hijackInternalLinks:function(){m()}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100,arrowScrollOnHover:false,trackClickSpeed:30,trackClickRepeatFreq:100,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false}
})(jQuery,this);