/*
 * jScrollPane - v2.0.0beta1 - 2010-08-02
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(F,E){var p=this,s,H,q,u,y,B,m,I,l,v,i,g,C,o,h,n;s={};z(E);function z(J){var L,K;u=F.parent(".jspContainer");if(u.length==0){F.css("overflow","hidden");H=F.innerWidth();q=F.innerHeight();F.css("overflow","visible");F.wrap(b("<div />").addClass("jspContainer").css({width:H+"px",height:q+"px"}));u=F.parent()}else{H=u.outerWidth();q=u.outerHeight();u.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}F.css({width:"auto",height:"auto"});L=F.clone().css("position","absolute");K=b('<div style="width:1px; position: relative;" />').append(L);b("body").append(K);y=Math.max(F.outerWidth(),L.outerWidth());K.remove();B=F.outerHeight();m=y/H;I=B/q;l=I>0.99;v=m>1;if(!(v||l)){F.removeClass("jspScrollable");F.css("top",0);t()}else{F.addClass("jspScrollable");G();D()}}function G(){if(l){var P,K,O,M,L,N,J;u.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));P=u.find(">.jspVerticalBar");K=P.find(">.jspTrack");i=K.find(">.jspDrag");O=P.position().left>0?"right":"left";F.css("margin-"+O,(E.verticalGutter+K.outerWidth())+"px");B=F.outerHeight();I=B/q;if(E.showArrows){N=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",x(0,-1));J=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",x(0,1));K.before(N).after(J)}M=q;u.find(">.jspVerticalBar>.jspCap,>.jspVerticalBar>.jspArrow").each(function(){M-=b(this).outerHeight()});K.height(M+"px");L=1/I*M;i.height(L+"px");g=M-L;C=0;i.hover(function(){i.addClass("jspHover")},function(){i.removeClass("jspHover")}).bind("mousedown.jsp",function(R){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var Q=R.pageY-i.position().top;b("html").bind("mousemove.jsp",function(S){j(S.pageY-Q)}).bind("mouseup.jsp mouseleave.jsp",A);return false});w()}else{t()}}function D(){if(v){var N,M,J,L,O,P,K;u.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));N=u.find(">.jspHorizontalBar");M=N.find(">.jspTrack");o=M.find(">.jspDrag");J=E.horizontalGutter+M.outerHeight();F.css("margin-bottom",J+"px");if(E.showArrows){P=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",x(-1,0));K=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",x(1,0));M.before(P).after(K)}L=u.innerWidth();u.find(">.jspHorizontalBar>.jspCap,>.jspHorizontalBar>.jspArrow").each(function(){L-=b(this).outerHeight()});M.width(L+"px");O=1/m*L;o.width(O+"px");h=L-O;n=0;o.hover(function(){o.addClass("jspHover")},function(){o.removeClass("jspHover")}).bind("mousedown.jsp",function(R){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var Q=R.pageX-o.position().left;b("html").bind("mousemove.jsp",function(S){k(S.pageX-Q)}).bind("mouseup.jsp mouseleave.jsp",A);return false})}else{}}function x(K,J){return function(){r(K,J);this.blur();return false}}function r(L,J){var K=setInterval(function(){if(L!=0){k(n+L*E.arrowButtonSpeed)}if(J!=0){j(C+J*E.arrowButtonSpeed)}},E.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(K);b("html").unbind("mouseup.jsp")})}function A(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")}function j(J){if(J<0){J=0}else{if(J>g){J=g}}C=J;i.css("top",J);u.scrollTop(0);var K=J/g;F.css("top",-K*(B-q))}function k(J){if(J<0){J=0}else{if(J>h){J=h}}n=J;o.css("left",J);u.scrollTop(0);
var K=J/h;F.css("left",-K*(y-H))}function w(){u.bind("mousewheel.jsp",function(J,L){var K=C;j(C-L*E.mouseWheelSpeed);return K==C})}function t(){u.unbind("mousewheel.jsp")}b.extend(p,{reinitialise:function(J){z(J)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);